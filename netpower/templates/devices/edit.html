{% extends "base.html" %}

{% block title %}编辑设备 - Wake on LAN{% endblock %}
{% block header %}编辑设备{% endblock %}

{% block content %}
<div class="edit-device">
    <h2>更新设备信息</h2>
    <form action="{{ url_for('devices.update_device', device_id=device_id) }}" method="post" id="edit-form">
        <label for="name">名称:</label>
        <input type="text" name="name" value="{{ device.name }}" required>
        <label for="mac">MAC地址:</label>
        <input type="text" name="mac" value="{{ device.mac }}" required>
        <label for="ip">IP地址:</label>
        <input type="text" name="ip" value="{{ device.ip }}" required>
        
        <div class="form-buttons">
            <button type="submit" class="primary-btn">更新设备</button>
            <a href="{{ url_for('devices.index') }}" class="secondary-btn">取消</a>
        </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
// 表单验证
document.getElementById('edit-form').addEventListener('submit', function(event) {
    const name = document.querySelector('input[name="name"]').value;
    const mac = document.querySelector('input[name="mac"]').value;
    const ip = document.querySelector('input[name="ip"]').value;
    
    // MAC地址格式验证
    const macPattern = /^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/;
    if (!macPattern.test(mac)) {
        alert('MAC地址格式无效。请使用格式：00:11:22:33:44:55');
        event.preventDefault();
        return;
    }
    
    // IP地址格式验证
    const ipPattern = /^(\d{1,3}\.){3}\d{1,3}$/;
    if (!ipPattern.test(ip)) {
        alert('IP地址格式无效。请使用格式：192.168.1.100');
        event.preventDefault();
        return;
    }
    
    // 验证IP地址范围
    const ipParts = ip.split('.');
    for (let part of ipParts) {
        const num = parseInt(part);
        if (num < 0 || num > 255) {
            alert('IP地址中的数字必须在0-255之间');
            event.preventDefault();
            return;
        }
    }
});
{% endblock %}
